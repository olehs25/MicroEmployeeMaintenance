<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>CRUD Springboot</title>

    <!-- links para exportar a excel -->
    <script src="https://unpkg.com/xlsx@0.16.9/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
    <script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BmbxuPwQa2lc/FVzBcNJ7UAyJxM6wuqIj61tLrc4wSX0szH/Ev+nYRRuWlolflfl" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css">

    <!-- Bootstrap CSS -->
    <link href="../static/css/bootstrap.css" rel="stylesheet"
          th:href="@{/css/bootstrap.css}">
</head>
<style>
    .container1 {
        margin-left: 3%;
        margin-right: 3%;
        margin-bottom: 5%;
    }
</style>
<body>
<div class="container1">
    <br>
    <h2 th:if="${list.isEmpty()}">
        No existen usuarios registrados</h2>
    <div th:if="${!list.isEmpty()}">
        <h2>
            Mantenimiento de Usuarios</h2>
        <br>
        <div class="card-body">
            <a id="btnExportar" class="btn btn-success">
                <i class="fas fa-file-excel"></i> Exportar datos a Excel
            </a>
                &nbsp;<a href="/user/save/0" class="btn btn-primary">Agregar Usuario
            </a>
                 &nbsp;<a href="/" class="btn btn-primary">Administradores

            </a>

            <br><br>
            <!--
            <br>
            <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Buscar por FullName..">
            -->
            <table id="tabla" class="table">
            <thead>
            <tr>
                <th>Id</th>
                <th>UserName</th>
                <th>Active</th>
                <th>Area</th>
                <th>Country</th>
                <th>CreationDate</th>
                <th>Email</th>
                <th>Language</th>
                <th>FullName</th>
                <th>Nif</th>
                <th>PersonalPhone</th>
                <th>Editar</th>
                <th>Eliminar</th>

            </tr>
            </thead>
            <tbody>
            <tr th:each="User : ${list}">
                <td th:text="${User.id}">
                <td th:text="${User.username}">
                <td th:text="${User.active}">
                <td th:text="${User.area}">
                <td th:text="${User.country}">
                <td th:text="${User.creationDate}">
                <td th:text="${User.email}">
                <td th:text="${User.language}">
                <td th:text="${User.fullName}">
                <td th:text="${User.nif}">
                <td th:text="${User.personalPhone}">
                <td><a class="btn btn-info" id="exclude"  th:href="@{/user/save/{id}(id=${User.id})}">Editar</a></td>
                <td><a class="btn btn-danger" data-toggle="modal" id="exclude2" th:href="@{/user/delete/{id}(id=${User.id})}">Eliminar</a></td>
            </tr>
            </tbody>

        </table>
    </div>

</div>
    <!-- Script para exportar a excel la tabla -->
    <script>
    const $btnExportar = document.querySelector("#btnExportar"),
        $tabla = document.querySelector("#tabla");

    $btnExportar.addEventListener("click", function() {
        let tableExport = new TableExport($tabla, {
            exportButtons: false, // No queremos botones
            filename: "Users", //Nombre del archivo de Excel
            sheetname: "Users", //Título de la hoja
             ignoreCols: [13,14],
        });
        let datos = tableExport.getExportData();
        let preferenciasDocumento = datos.tabla.xlsx;
        tableExport.export2file(preferenciasDocumento.data, preferenciasDocumento.mimeType, preferenciasDocumento.filename, preferenciasDocumento.fileExtension, preferenciasDocumento.merges, preferenciasDocumento.RTL, preferenciasDocumento.sheetname);
    });
</script>

    <!-- Script para añadir un filtrado por FullName en la tabla -->
    <!--
   <script>
function myFunction() {
 var input, filter, table, tr, td, i, txtValue;
 input = document.getElementById("myInput");
 filter = input.value.toUpperCase();
 table = document.getElementById("tabla");
 tr = table.getElementsByTagName("tr");
 for (i = 0; i < tr.length; i++) {
   td = tr[i].getElementsByTagName("td")[1];
   if (td) {
     txtValue = td.textContent || td.innerText;
     if (txtValue.toUpperCase().indexOf(filter) > -1) {
       tr[i].style.display = "";
     } else {
       tr[i].style.display = "none";
     }
   }
 }
}
</script>
-->
   <!-- JQUERY -->
    <script src="https://code.jquery.com/jquery-3.4.1.js"
            integrity="sha256-WpOohJOqMqqyKL9FccASB9O0KwACQJpFTUBLTYOVvVU=" crossorigin="anonymous">
    </script>
    <!-- DATATABLES -->
    <script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js">
    </script>
    <!-- BOOTSTRAP -->
    <script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js">
    </script>
    <script>
        $(document).ready(function () {
            $('#tabla').DataTable();
             });
    </script>


</div>
</body>
</html>